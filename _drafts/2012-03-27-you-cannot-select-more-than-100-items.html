---
layout: post
title: '"You cannot select more than 100 items at once" in SharePoint 2010'
date: '2012-03-27T15:49:00.001+02:00'
author: Marek Mierzwa
tags:
- limits
- javascript
- view
- sharepoint 2010
modified_time: '2012-03-27T15:49:15.343+02:00'
thumbnail: http://4.bp.blogspot.com/-x3yJKaOISio/T3Gq_AatsxI/AAAAAAAABPY/TWC01l-4HRk/s72-c/items_selection_limit_error.PNG
blogger_id: tag:blogger.com,1999:blog-2283486810269355053.post-273667762726925100
blogger_orig_url: http://byteloom.blogspot.com/2012/03/you-cannot-select-more-than-100-items.html
---

Looking for some solution for batch items update I've run into the  following problem: when I clicked a checkbox in top right corner of the  list (acually a document library) "All Items" view, the browser  displayed an error:&nbsp; "You cannot select more than 100 items at once."<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-x3yJKaOISio/T3Gq_AatsxI/AAAAAAAABPY/TWC01l-4HRk/s1600/items_selection_limit_error.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="141" src="http://4.bp.blogspot.com/-x3yJKaOISio/T3Gq_AatsxI/AAAAAAAABPY/TWC01l-4HRk/s320/items_selection_limit_error.PNG" width="320" /></a></div><br />The problem was discussed on the TechNet forum (<a href="http://social.technet.microsoft.com/Forums/en-US/sharepoint2010general/thread/9c99cc7e-68d0-43f6-bd7b-ca5b54f2d5bf" target="_blank">Selecting more than 100 files in Document Library</a>)  and the limit of maximum 100 items per one batch update (like check-in,  delete etc.) is described <a href="http://technet.microsoft.com/en-us/library/cc262787.aspx#ListLibrary" target="_blank">on MSDN</a>:<br /><blockquote class="tr_bq">Limit: Bulk operations<br />Maximum value: 100 items per bulk operation<br />Limit type: Boundary<br />Notes: The user interface allows a maximum of 100 items to be selected for bulk operations.</blockquote>What is interesting and what was not mentioned in TechNet topic, the limit is controlled on client side by a script, what I will show.<br /><a name='more'></a>What happens when you click on select-all-items check box? This is a pseudo-callstack of JS calls:<br /><br /><pre class="brush: html">&lt;input type="checkbox" <br />       title="Select or deselect all items" <br />       onclick="ToggleAllItems(event,this,21)" <br />       onfocus="EnsureSelectionHandlerOnFocus(event,this,21)" /><br /></pre><br /><pre class="brush: text">onClick (the view HTML) -><br />ToggleAllItems(evt, cbx, ctxNum) (init.js) -><br />CoreInvoke(fn) (init.js) -><br />_ToggleAllItems(evt, cbx, ctxNum) (core.js) -><br />ToggleAllItems2(cbx, ctxNum, f) (core.js) -><br /></pre><br />In the last function - ToggleAllItems2 - you will find the following pieces of code:<br /><br /><pre class="brush: javascript">var totalItems=CountTotalItems(ctxCur);<br />...<br />if (totalItems > g_MaximumSelectedItemsAllowed)<br />{<br />    cbx.checked=false;<br />    alert(L_BulkSelection_TooManyItems);<br />    return;<br />}<br /></pre><br />Variables g_MaximumSelectedItemsAllowed and L_BulkSelection_TooManyItems are defined in the same file (core.js):<br /><br /><pre class="brush: javascript">var g_MaximumSelectedItemsAllowed=100;<br />var L_BulkSelection_TooManyItems="You cannot select more than 100 items at once.";<br /></pre><br />You will find a similar code checking if the limits are also preserved when user checks items one by one.<br />The second interesting thing is that the number of items is checked only on client side, so if you change g_MaximumSelectedItemsAllowed value to, let say 200, you will be able to make a batch update for more items than the official limit allows.<br />I've managed to change this by IE developers toolbar for 200 items:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-M8MSNuJtDys/T3GrB8M-tCI/AAAAAAAABPw/JMR0Upsnc_U/s1600/maximum_selected_items_limit_overwrite_3.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="153" src="http://1.bp.blogspot.com/-M8MSNuJtDys/T3GrB8M-tCI/AAAAAAAABPw/JMR0Upsnc_U/s320/maximum_selected_items_limit_overwrite_3.PNG" width="320" /></a></div><br />Of course if you want to change this permanently (probably with changing the message string L_BulkSelection_TooManyItems also to not confuse users) you still will have to develop some more persistent solution - i.e. deploy your custom script into Layouts folder, link it on selected pages and so on. The code would look like this (I assume you have jquery included):<br /><br /><pre class="brush: javascript">$(document).ready(function() {<br />    g_MaximumSelectedItemsAllowed = 200;<br />    L_BulkSelection_TooManyItems = "You cannot select more than ' + g_MaximumSelectedItemsAllowed + ' items at once.";<br />});<br /></pre><br />There is one other issue I should mention. Limit of 100 items has been set for some reason - probably the performance. I've managed to update value of a column for 200 items with <a href="http://sp2010batchedit.codeplex.com" target="_blank">BatchEdit from codeplex</a> but checking-in the same number of items failed (I've got some strange JS error). Still I was able to check-in 110 items which was above the standard limit.<br /><br />Happy sharepointing!